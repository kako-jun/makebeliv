# Makebeliv è¨­è¨ˆæ±ºå®šè¨˜éŒ² (ADR: Architecture Decision Records)

è¨­è¨ˆä¸Šã®é‡è¦ãªæ±ºå®šã¨ãã®ç†ç”±ã‚’è¨˜éŒ²ã—ã¾ã™ã€‚

---

## ADR-001: Rust + Python ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ§‹æˆã‚’æ¡ç”¨

**æ—¥ä»˜**: 2025-11-17
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ¡ç”¨
**æ±ºå®šè€…**: åˆæœŸè¨­è¨ˆ

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

ãƒœã‚¤ã‚¹ãƒã‚§ãƒ³ã‚¸ãƒ£ãƒ¼ã‚’å®Ÿè£…ã™ã‚‹ã«ã‚ãŸã‚Šã€ä»¥ä¸‹ã®é¸æŠè‚¢ãŒã‚ã£ãŸï¼š
1. Pythonå˜ä½“
2. Rustå˜ä½“
3. Rust + Python ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰

### æ±ºå®š

**Rust + Python ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ§‹æˆã‚’æ¡ç”¨**

### ç†ç”±

#### Pythonå˜ä½“ã®å ´åˆ
âœ… RVCï¼ˆPyTorchï¼‰ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ãŒå……å®Ÿ
âœ… å®Ÿè£…ãŒå®¹æ˜“
âŒ GIL (Global Interpreter Lock) ã«ã‚ˆã‚‹éŸ³å£°I/Oã®é…å»¶
âŒ GC (Garbage Collection) ã«ã‚ˆã‚‹äºˆæ¸¬ä¸å¯èƒ½ãªé…å»¶
âŒ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ã«èª²é¡Œ

#### Rustå˜ä½“ã®å ´åˆ
âœ… ä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·éŸ³å£°I/O
âœ… GCãƒ»GILãªã—
âŒ PyTorchã®åˆ©ç”¨ãŒå›°é›£ï¼ˆtch-rsã¯æœªæˆç†Ÿï¼‰
âŒ RVCãƒ¢ãƒ‡ãƒ«ã®ç§»æ¤ãŒç¾å®Ÿçš„ã§ãªã„
âŒ ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ãŒä¹ã—ã„

#### ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ§‹æˆï¼ˆæ¡ç”¨ï¼‰
âœ… Rustã§éŸ³å£°I/Oã‚’æ‹…å½“ï¼ˆä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ï¼‰
âœ… Pythonã§RVCæ¨è«–ã‚’æ‹…å½“ï¼ˆã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ æ´»ç”¨ï¼‰
âœ… ãã‚Œãã‚Œã®å¼·ã¿ã‚’æ´»ã‹ã›ã‚‹
âš ï¸ é€šä¿¡ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒç™ºç”Ÿï¼ˆè¨±å®¹ç¯„å›²ï¼‰

### çµæœ

- éŸ³å£°I/O: Rust (cpal)
- RVCæ¨è«–: Python (PyTorch)
- é€šä¿¡: HTTP POST (localhost)

---

## ADR-002: HTTP POST ã«ã‚ˆã‚‹é€šä¿¡ã‚’æ¡ç”¨

**æ—¥ä»˜**: 2025-11-17
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ¡ç”¨

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

Rust â‡” Python ã®é€šä¿¡æ–¹å¼ã¨ã—ã¦ä»¥ä¸‹ã‚’æ¤œè¨ï¼š
1. HTTP POST (multipart)
2. gRPC
3. WebSocket
4. IPC (Unix Domain Socket, Named Pipe)

### æ±ºå®š

**HTTP POST (multipart) ã‚’æ¡ç”¨**

### ç†ç”±

#### HTTP POST
âœ… ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œãŒå®¹æ˜“
âœ… å®Ÿè£…ãŒã‚·ãƒ³ãƒ—ãƒ«ï¼ˆFastAPI, reqwestï¼‰
âœ… ãƒ‡ãƒãƒƒã‚°ã—ã‚„ã™ã„ï¼ˆcurlç­‰ã§ç¢ºèªå¯èƒ½ï¼‰
âœ… é…å»¶ã‚‚è¨±å®¹ç¯„å›²ï¼ˆlocalhost ã§ 5-10msç¨‹åº¦ï¼‰
âŒ ãƒã‚¤ãƒŠãƒªåŠ¹ç‡ã¯åŠ£ã‚‹

#### gRPC
âœ… é«˜é€Ÿã€ãƒã‚¤ãƒŠãƒªåŠ¹ç‡ãŒè‰¯ã„
âŒ å®Ÿè£…ãŒè¤‡é›‘
âŒ ãƒ‡ãƒãƒƒã‚°ãŒé›£ã—ã„
âŒ ã‚ªãƒ¼ãƒãƒ¼ã‚¹ãƒšãƒƒã‚¯

#### WebSocket
âœ… åŒæ–¹å‘é€šä¿¡ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‘ã‘
âŒ å®Ÿè£…ãŒè¤‡é›‘
âŒ ã‚ªãƒ¼ãƒãƒ¼ã‚¹ãƒšãƒƒã‚¯ï¼ˆã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãŒä¸è¦ï¼‰

#### IPC
âœ… æœ€é€Ÿï¼ˆæ•°Î¼sï¼‰
âŒ Unix Domain Socket ã¯ Windows éå¯¾å¿œï¼ˆå¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰
âŒ ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œãŒé›£ã—ã„
âŒ å®Ÿè£…ãŒè¤‡é›‘

### çµæœ

- é€šä¿¡: HTTP POST (multipart/form-data)
- ã‚µãƒ¼ãƒãƒ¼: FastAPI + Uvicorn
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ: Rust reqwest

---

## ADR-003: å†ç”Ÿå‡¦ç†ã¯ Python å´ã§å®Ÿè¡Œ

**æ—¥ä»˜**: 2025-11-17
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ¡ç”¨

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

éŸ³å£°å¤‰æ›å¾Œã®å†ç”Ÿå‡¦ç†ã‚’ã©ã¡ã‚‰ã§è¡Œã†ã‹ï¼š
1. Rustå´ã§å†ç”Ÿï¼ˆå¾€å¾©é€šä¿¡ï¼‰
2. Pythonå´ã§å†ç”Ÿï¼ˆç‰‡é“é€šä¿¡ï¼‰

### æ±ºå®š

**Pythonå´ã§å†ç”Ÿã‚’å®Ÿè¡Œ**

### ç†ç”±

#### Rustå´ã§å†ç”Ÿ
âŒ Rust â†’ Python â†’ Rust ã®2å›ã®é€šä¿¡ãŒå¿…è¦
âŒ é€šä¿¡ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå€å¢—
âŒ éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®å¾€å¾©é€ä¿¡ãŒéåŠ¹ç‡

#### Pythonå´ã§å†ç”Ÿï¼ˆæ¡ç”¨ï¼‰
âœ… Rust â†’ Python ã®ç‰‡é“é€šä¿¡ã®ã¿
âœ… é€šä¿¡ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒåŠåˆ†
âœ… Pythonå´ã§å¤‰æ›å¾Œã™ãã«å†ç”Ÿå¯èƒ½
âš ï¸ Python ã®éŸ³å£°å†ç”Ÿã¯Rustã»ã©ä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã§ã¯ãªã„
  â†’ ãŸã ã—ã€RVCæ¨è«–ãŒãƒœãƒˆãƒ«ãƒãƒƒã‚¯ãªã®ã§å½±éŸ¿ã¯å°ã•ã„

### çµæœ

- éŒ²éŸ³: Rust (cpal)
- å¤‰æ›: Python (RVC + æºã‚‰ã)
- å†ç”Ÿ: Python (sounddevice) ã¾ãŸã¯ä»®æƒ³ãƒã‚¤ã‚¯å‡ºåŠ›

---

## ADR-004: uv ã‚’Pythonç’°å¢ƒç®¡ç†ã«æ¡ç”¨

**æ—¥ä»˜**: 2025-11-17
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ¡ç”¨

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

Pythonç’°å¢ƒç®¡ç†ãƒ„ãƒ¼ãƒ«ã®é¸å®šï¼š
1. pip + venv (æ¨™æº–)
2. poetry
3. conda
4. **uv** (Astralè£½)

### æ±ºå®š

**uv ã‚’æ¡ç”¨**

### ç†ç”±

#### pip + venv
âœ… æ¨™æº–ã€å®‰å®š
âŒ é…ã„ï¼ˆä¾å­˜é–¢ä¿‚è§£æ±ºãŒéåŠ¹ç‡ï¼‰
âŒ ãƒ­ãƒƒã‚¯æ©Ÿèƒ½ãŒãªã„

#### poetry
âœ… ãƒ¢ãƒ€ãƒ³ã€ä¾å­˜é–¢ä¿‚ç®¡ç†ãŒå„ªç§€
âŒ é…ã„
âŒ è¤‡é›‘

#### conda
âœ… ç§‘å­¦è¨ˆç®—å‘ã‘ã«æœ€é©åŒ–
âŒ é…ã„
âŒ ã‚µã‚¤ã‚ºãŒå¤§ãã„

#### uvï¼ˆæ¡ç”¨ï¼‰
âœ… **è¶…é«˜é€Ÿ**ï¼ˆpipã®10-100å€ï¼‰
âœ… **Rustãƒ™ãƒ¼ã‚¹**ï¼ˆmakebelivã®Rustéƒ¨åˆ†ã¨è¦ªå’Œæ€§ï¼‰
âœ… ä¾å­˜é–¢ä¿‚è§£æ±ºãŒè³¢ã„
âœ… ã‚·ãƒ³ãƒ—ãƒ«ãªAPI
âœ… pipäº’æ›

### çµæœ

- å…¨ã¦ã®Pythonç’°å¢ƒæ§‹ç¯‰ã« `uv` ã‚’ä½¿ç”¨
- ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: `scripts/setup.sh`
- Dockerfileå†…ã§ã‚‚ `uv` ã‚’ä½¿ç”¨
- Pythonå®Ÿè¡Œ: `uv run python ...`

---

## ADR-005: ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºã‚’ 100ms ã«è¨­å®š

**æ—¥ä»˜**: 2025-11-17
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ¡ç”¨ï¼ˆèª¿æ•´å¯èƒ½ï¼‰

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†ã®ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºã‚’æ±ºå®šï¼š
- å°ã•ã„ï¼ˆ50msï¼‰: ä½é…å»¶ã ãŒå‡¦ç†å›æ•°ãŒå¤šã„
- ä¸­ï¼ˆ100msï¼‰: ãƒãƒ©ãƒ³ã‚¹
- å¤§ãã„ï¼ˆ200msï¼‰: é«˜é…å»¶ã ãŒå‡¦ç†å›æ•°ãŒå°‘ãªã„

### æ±ºå®š

**100ms ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨ã™ã‚‹**ï¼ˆè¨­å®šã§å¤‰æ›´å¯èƒ½ï¼‰

### ç†ç”±

| ã‚µã‚¤ã‚º | é…å»¶ | å‡¦ç†é »åº¦ | ãƒãƒ£ãƒ³ã‚¯å¢ƒç•Œ | è©•ä¾¡ |
|-------|------|---------|------------|------|
| 50ms | ä½ | é«˜ï¼ˆ20å›/ç§’ï¼‰ | ç›®ç«‹ã¤ | âŒ |
| 100ms | ä¸­ | ä¸­ï¼ˆ10å›/ç§’ï¼‰ | è¨±å®¹ç¯„å›² | âœ… |
| 200ms | é«˜ | ä½ï¼ˆ5å›/ç§’ï¼‰ | ç›®ç«‹ãŸãªã„ | â–³ |

### çµæœ

- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º: **100ms**
- è¨­å®šå¯èƒ½ã«ã™ã‚‹ï¼ˆå°†æ¥çš„ã«ï¼‰
- å®Ÿæ¸¬å€¤ã«åŸºã¥ã„ã¦èª¿æ•´

---

## ADR-006: ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆã‚’ 16kHz ã«çµ±ä¸€

**æ—¥ä»˜**: 2025-11-17
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ¡ç”¨

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

éŸ³å£°å‡¦ç†ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆé¸å®šï¼š
- 8kHz: é›»è©±å“è³ª
- 16kHz: éŸ³å£°èªè­˜ãƒ»VCã®æ¨™æº–
- 44.1kHz/48kHz: CDå“è³ª

### æ±ºå®š

**16kHz ã‚’æ¡ç”¨**

### ç†ç”±

#### 16kHzï¼ˆæ¡ç”¨ï¼‰
âœ… RVCã®æ¨å¥¨ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ
âœ… è¨ˆç®—é‡ãŒå°‘ãªã„ï¼ˆ44.1kHzã®1/3ï¼‰
âœ… éŸ³å£°èªè­˜ãƒ¢ãƒ‡ãƒ«ã¨ã®äº’æ›æ€§
âœ… äººé–“ã®å£°ã®å†ç¾ã«ååˆ†

#### 44.1kHz/48kHz
âœ… é«˜éŸ³è³ª
âŒ è¨ˆç®—é‡ãŒå¤šã„ï¼ˆ3å€ï¼‰
âŒ RVCãƒ¢ãƒ‡ãƒ«ã®å†è¨“ç·´ãŒå¿…è¦
âŒ ã‚ªãƒ¼ãƒãƒ¼ã‚¹ãƒšãƒƒã‚¯ï¼ˆéŸ³è³ªã¯è¦ä»¶ã§ã¯ãªã„ï¼‰

### çµæœ

- å…¨ã¦ã®éŸ³å£°å‡¦ç†: **16kHz**
- å…¥åŠ›éŸ³å£°ã¯è‡ªå‹•ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°

---

## ADR-007: Dockerå¯¾å¿œã‚’è¿½åŠ ï¼ˆGPU/CPUä¸¡å¯¾å¿œï¼‰

**æ—¥ä»˜**: 2025-11-17
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ¡ç”¨

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã®é¸å®šï¼š
1. ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œã®ã¿
2. Dockerå¯¾å¿œ
3. Kuberneteså¯¾å¿œ

### æ±ºå®š

**Dockerå¯¾å¿œã‚’è¿½åŠ ï¼ˆGPU/CPUä¸¡å¯¾å¿œï¼‰**

### ç†ç”±

#### ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œã®ã¿
âœ… ã‚·ãƒ³ãƒ—ãƒ«
âŒ ç’°å¢ƒæ§‹ç¯‰ãŒç…©é›‘
âŒ ç’°å¢ƒå·®ç•°ã«ã‚ˆã‚‹ãƒˆãƒ©ãƒ–ãƒ«

#### Dockerå¯¾å¿œï¼ˆæ¡ç”¨ï¼‰
âœ… ç’°å¢ƒã®å†ç¾æ€§ãŒé«˜ã„
âœ… ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®¹æ˜“
âœ… GPU/CPUä¸¡å¯¾å¿œã§æŸ”è»Ÿ
âš ï¸ ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚µã‚¤ã‚ºãŒå¤§ãã„ï¼ˆ6-7GBï¼‰

#### Kubernetes
âœ… ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£
âŒ ã‚ªãƒ¼ãƒãƒ¼ã‚¹ãƒšãƒƒã‚¯ï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ³å®šï¼‰

### çµæœ

- `Dockerfile` (GPUç‰ˆ)
- `Dockerfile.cpu` (CPUç‰ˆ)
- `docker-compose.yml`
- uvã‚’Dockerå†…ã§ã‚‚ä½¿ç”¨

---

## ADR-008: ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã®å®Ÿè£…

**æ—¥ä»˜**: 2025-11-17
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ¡ç”¨

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

RVCãƒ¢ãƒ‡ãƒ«ãŒãªã„å ´åˆã®å‹•ä½œï¼š
1. ã‚¨ãƒ©ãƒ¼ã§åœæ­¢
2. ã‚¹ã‚­ãƒƒãƒ—ï¼ˆãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼ï¼‰
3. ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ï¼ˆç°¡æ˜“å¤‰æ›ï¼‰

### æ±ºå®š

**ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆã®ã¿ï¼‰ã‚’å®Ÿè£…**

### ç†ç”±

#### ã‚¨ãƒ©ãƒ¼ã§åœæ­¢
âœ… æ˜ç¢º
âŒ é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆãŒã§ããªã„

#### ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼
âœ… å‹•ä½œã¯ã™ã‚‹
âŒ å¤‰æ›ã•ã‚Œãªã„ã®ã§æ„å‘³ãŒãªã„

#### ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ï¼ˆæ¡ç”¨ï¼‰
âœ… ãƒ¢ãƒ‡ãƒ«ãªã—ã§ã‚‚å‹•ä½œç¢ºèªã§ãã‚‹
âœ… ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆã ã‘ã§ã‚‚ä¸€å®šã®åŠ¹æœ
âœ… é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“
âš ï¸ æœ¬ç•ªåˆ©ç”¨ã«ã¯ä¸å‘ã

### çµæœ

```python
if self.model is None:
    logger.warning("ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ - ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆã®ã¿")
    return self._demo_conversion(audio, sr)
```

---

## ADR-009: FastAPIã®éåŒæœŸå‡¦ç†ã‚’æ¡ç”¨

**æ—¥ä»˜**: 2025-11-17
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ¡ç”¨

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

APIã‚µãƒ¼ãƒãƒ¼ã®å‡¦ç†æ–¹å¼ï¼š
1. åŒæœŸå‡¦ç†ï¼ˆFlaskç­‰ï¼‰
2. éåŒæœŸå‡¦ç†ï¼ˆFastAPIç­‰ï¼‰

### æ±ºå®š

**FastAPI + Uvicornï¼ˆéåŒæœŸï¼‰ã‚’æ¡ç”¨**

### ç†ç”±

#### åŒæœŸå‡¦ç†
âœ… ã‚·ãƒ³ãƒ—ãƒ«
âŒ ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ï¼ˆ1ãƒªã‚¯ã‚¨ã‚¹ãƒˆãšã¤å‡¦ç†ï¼‰
âŒ ä¸¦åˆ—å‡¦ç†ãŒã§ããªã„

#### éåŒæœŸå‡¦ç†ï¼ˆæ¡ç”¨ï¼‰
âœ… ãƒãƒ³ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°
âœ… è¤‡æ•°ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä¸¦åˆ—å‡¦ç†å¯èƒ½
âœ… I/Oå¾…ã¡æ™‚é–“ã‚’æ´»ç”¨
âœ… FastAPIã¯é«˜é€Ÿãƒ»ãƒ¢ãƒ€ãƒ³

### çµæœ

```python
@app.post("/convert")
async def convert_audio(...):
    audio_bytes = await audio.read()  # éåŒæœŸI/O
    # ...
```

---

## ADR-010: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã«ã‚ˆã‚‹æºã‚‰ãã®é€£ç¶šæ€§

**æ—¥ä»˜**: 2025-11-17
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ¡ç”¨

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

æºã‚‰ãã‚¨ãƒ³ã‚¸ãƒ³ã®çŠ¶æ…‹ç®¡ç†ï¼š
1. çŠ¶æ…‹ãªã—ï¼ˆæ¯å›ãƒªã‚»ãƒƒãƒˆï¼‰
2. ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã§çŠ¶æ…‹ç®¡ç†

### æ±ºå®š

**ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã§çŠ¶æ…‹ç®¡ç†**

### ç†ç”±

#### çŠ¶æ…‹ãªã—
âŒ ãƒãƒ£ãƒ³ã‚¯ã”ã¨ã«æºã‚‰ããŒãƒªã‚»ãƒƒãƒˆ
âŒ ä¸è‡ªç„¶ãªå¤‰åŒ–ï¼ˆã‚«ã‚¯ã‚«ã‚¯ã™ã‚‹ï¼‰

#### ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆæ¡ç”¨ï¼‰
âœ… é•·ã„ç™ºè©±ã§ã‚‚æºã‚‰ããŒé€£ç¶š
âœ… è‡ªç„¶ãªå¤‰åŒ–
âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ã”ã¨ã«ç‹¬ç«‹
âš ï¸ ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒå¢—ãˆã‚‹ï¼ˆè»½å¾®ï¼‰

### çµæœ

```python
class ServerState:
    def __init__(self):
        self.fluctuation_engines = {}  # session_id -> FluctuationEngine

def get_or_create_fluctuation_engine(session_id: str):
    if session_id not in self.fluctuation_engines:
        self.fluctuation_engines[session_id] = FluctuationEngine(...)
    return self.fluctuation_engines[session_id]
```

---

## ğŸ“‹ æ±ºå®šã®å„ªå…ˆé †ä½

| å„ªå…ˆåº¦ | é …ç›® | å¤‰æ›´å¯èƒ½æ€§ |
|--------|------|-----------|
| ğŸ”´ é«˜ | Rust+Pythonæ§‹æˆ | ä½ |
| ğŸ”´ é«˜ | uvæ¡ç”¨ | ä½ |
| ğŸŸ¡ ä¸­ | HTTPé€šä¿¡ | ä¸­ |
| ğŸŸ¡ ä¸­ | 16kHz ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ | ä¸­ |
| ğŸŸ¢ ä½ | ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º | é«˜ï¼ˆèª¿æ•´å¯èƒ½ï¼‰ |

---

## ğŸ”„ ä»Šå¾Œã®æ¤œè¨äº‹é …

1. **ONNXåŒ–ã®æ¤œè¨** - RVCãƒ¢ãƒ‡ãƒ«ã®ONNXåŒ–ã§Rustæ¨è«–ãŒå¯èƒ½ã«ï¼Ÿ
2. **WebSocketæ¤œè¨** - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ã‚’ã•ã‚‰ã«å‘ä¸Šã•ã›ã‚‹å ´åˆ
3. **ãƒ¢ãƒ‡ãƒ«ãƒ›ãƒƒãƒˆã‚¹ãƒ¯ãƒƒãƒ—** - ã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•ãªã—ã§ãƒ¢ãƒ‡ãƒ«åˆ‡ã‚Šæ›¿ãˆ

---

**æœ€çµ‚æ›´æ–°**: 2025-11-17
**ç®¡ç†è€…**: Claude/kako-jun
